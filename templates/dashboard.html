<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
</head>

<body>
  <p>Hello {{ session['fname'] }} {{ session["lname"] }}</p>
  <a href="{{ url_for('add_object') }}"><button>Add object</button></a><br>
  <a href="{{ url_for('logout') }}">LOGOUT</a><br>
  <a href="{{ url_for('profile') }}">Profile</a><br>

  {% if session["level"] >= 20 %}
  <a href="{{ url_for('admin_panel') }}">Admin Panel</a>
  {% endif %}

  <h1>Objects list</h1>

  {% if request.args.get('message') %}
  <p style="color:red">{{ request.args.get('message') }}</p>
  {% endif %}

  {% for table_name, rows in objects.items() %}
  <h2>{{ table_name }}</h2>
  {% if rows %}
  <table border="1">
    <tr>
      {% for column in rows[0].keys() %}
      {% if column != "id" %} {# Ne pas afficher la colonne id #}
      <th>{{ column }}</th>
      {% endif %}
      {% endfor %}
      <th>Action</th>
    </tr>
    {% for row in rows %}
    <tr>
      {% for column, value in row.items() %}
      {% if column != "id" %} {# Ne pas afficher la colonne id #}
      <td>{{ value }}</td>
      {% endif %}
      {% endfor %}
      <td>
        <form action="{{ url_for('delete_object', table_name=table_name, object_id=row['id']) }}" method="post"
          style="display:inline;">
          <input type="hidden" name="object_id" value="{{ row['id'] }}">
          <button type="submit" onclick="return confirm('Are you sure you want to delete this object?');">Delete
            object</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
  <p>No objects in this category.</p>
  {% endif %}
  {% endfor %}
</body>

</html>